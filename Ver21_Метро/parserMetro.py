import openpyxl

# Загрузим существующий Excel-файл
wb = openpyxl.load_workbook("flatsWithMetrotime.xlsx")
ws = wb.active

# Словарь с рейтингами для метро
metro_ratings = {
    "Раменки": 7,
    "Трубная": 6,
    "Проспект Вернадского": 8,
    "Третьяковская": 9,
    "Аэропорт": 8,
    "Битца": 5,
    "Улица 1905 года": 7,
    "Поклонная": 7,
    "Кантемировская": 6,
    "Шелепиха": 8,
    "Депо": 5,
    "Минская": 7,
    "Сухаревская": 8,
    "Москва-Сити": 9,
    "Арбатская": 9,
    "Народное Ополчение": 6,
    "Южная": 6,
    "Кропоткинская": 8,
    "Ломоносовский проспект": 7,
    "Октябрьское поле": 7,
    "ЦСКА": 8,
    "Серебряный Бор": 6,
    "Ботанический сад": 7,
    "Молодёжная": 6,
    "Студенческая": 5,
    "Марьино": 5,
    "Аминьевская": 5,
    "Профсоюзная": 6,
    "Братиславская": 6,
    "Фили": 7,
    "Марксистская": 6,
    "Матвеевская": 5,
    "Щукинская": 7,
    "Университет": 9,
    "Серпуховская": 7,
    "Театральная": 8,
    "Шаболовская": 7,
    "Смоленская": 8,
    "Бульвар Генерала Карбышева": 5,
    "Таганская": 7,
    "Новокузнецкая": 7,
    "Маяковская": 9,
    "Спортивная": 6,
    "Измайловская": 6,
    "Пушкинская": 8,
    "Давыдково": 5,
    "Краснопресненская": 8,
    "Верхние котлы": 5,
    "Октябрьская": 7,
    "Лермонтовский проспект": 5,
    "Свиблово": 7,
    "Академическая": 8,
    "Автозаводская": 6,
    "Чкаловская": 5,
    "Площадь трёх вокзалов": 7,
    "Поклонная": 7,
    "Электрозаводская": 6,
    "Лианозово": 5,
    "ЗИЛ": 5,
    "Полежаевская": 6,
    "Фонвизинская": 5,
    "Пролетарская": 6,
    "Авиамоторная": 5,
    "Молодёжная": 6,
    "Лихоборы": 6,
    "Юго-Западная": 7,
    "Крымская": 6,
    "Киевская": 7,
    "Сокольники": 7,
    "Бауманская": 6,
    "Ленинский проспект": 7,
    "Физтех": 5,
    "Полянка": 6,
    "Курская": 7,
    "Новогиреево": 5,
    "Гражданская": 6,
    "Достоевская": 6,
    "Мнёвники": 5,
    "Смоленская": 7,
    "Измайловская": 5,
    "Воробьёвы горы": 7,
    "Тёплый Стан": 6,
    "Цветной бульвар": 7,
    "Зюзино": 5,
    "Красные ворота": 6,
    "Панфиловская": 5,
    "Гражданская": 6,
    "Кузнецкий мост": 7,
    "Тимирязевская": 7,
    "Тверская": 8,
    "Фрунзенская": 7,
    "Беляево": 6,
    "Университет Дружбы Народов": 8,
    "Добрынинская": 6,
    "Новопеределкино": 3,  
    "Новые Черёмушки": 6,
    "Стрешнево": 7,
    "Охотный ряд": 8,
    "Сретенский бульвар": 7,
    "Баррикадная": 8,
    "Беломорская": 6,
    "Селигерская": 6,
    "Красный Балтиец": 5,
    "Белорусская": 8,
    "Проспект Мира": 8,
    "Ясенево": 6,
    "Беговая": 7,
    "Новослободская": 7,
    "Отрадное": 5,
    "Чеховская": 7,        # Центральное расположение, относительно удобное
    "Крылатское": 6,       # Достаточно отдалённое от центра
    "Алексеевская": 7,     # Среднее расположение, с хорошими транспортными связями
    "Нагатинский Затон": 5, # Район с развивающейся инфраструктурой, но далековато
    "Парк Победы": 8,      # Центр, хорошее соединение с другими линиями
    "Тургеневская": 8,     # Центральное расположение
    "Сходненская": 6,      # В северной части Москвы, доступность транспорта
    "Перерва": 5,          # Далеко от центра, не так популярна
    "Кутузовская": 7,      # Центральная станция, хороший транспортный узел
    "Павелецкая": 8,       # Удобное расположение, важный транспортный узел
    "Тропарёво": 6,        # Отдалённое, но достаточно развитое место
    "Спартак": 6,          # Ожидаемое развитие, но не в центре
    "Ховрино": 5,          # Отдалённая станция
    "Некрасовка": 5,       # Отдалённое расположение
    "Технопарк": 7,        # Новый район, хорошее транспортное соединение
    "Щёлковская": 6,       # Восток Москвы, не слишком близко к центру
    "Славянский бульвар": 7, # Развивающийся район, хорошая транспортная доступность
    "Крестьянская застава": 7, # Удобное расположение на юго-востоке Москвы
    "Тропарёво": 6,         # Как уже упоминалось, не в центре, но удобное соединение
    "Павшино": 5,          # Отдалённая станция
    "Дубровка": 6,         # Среднее расположение
    "Рабочий посёлок": 5,  # Не очень популярная станция
    "Строгино": 6,         # Удобное расположение на севере
    "Площадь Ильича": 7,   # Хорошая транспортная доступность
    "Боровицкая": 8,       # Центральное расположение, хороший транспортный узел
    "Солнцево": 5,         # Отдалённая станция, но развивающийся район
    "Вавиловская": 7,      # В центре, с хорошими транспортными связями
    "Угрешская": 5,        # Отдалённое расположение
    "Кунцевская": 7,       # Хороший транспортный узел
    "Дмитровская": 6,      # Северный район, хорошее соединение с другими линиями
    "Люблино": 5,          # Далеко от центра, но развивающийся район
    "Царицыно": 6,         # Хорошее расположение на юге Москвы
    "ВДНХ": 9,             # Центральная станция, важный транспортный узел
    "Дегунино": 5,         # Станция на северо-востоке города
    "Чистые пруды": 8,     # Центр города, удобное расположение
    "Пионерская": 7,       # Хорошее расположение на западной части
    "Хорошёвская": 8,       # Удобное расположение, хороший транспортный узел
    "Китай-город": 8,  
    "Коптево": 6,  
    "Войковская": 7,  
    "Шипиловская": 7,  
    "Менделеевская": 8,  
    "Преображенская": 7,  
    "Сокол": 8,  
    "Парк Культуры": 9,  
    "Семёновская": 5,  
    "Водный стадион": 7,  
    "Мичуринский проспект": 8,  
    "Преображенская площадь": 7,  
    "Новаторская": 7,  
    "Варшавская": 5,  
    "Бульвар Дмитрия Донского": 4,  
    "Лужники": 9,  
    "Нагатинская": 6,  
    "Коломенская": 6,
    "Озёрная": 4,
    "Динамо": 8,
    "Орехово": 3,
    "Митино": 2,
    "Печатники": 6,
    "Планерная": 3,
    "Коньково": 4,
    "Новокосино": 3,
    "Говорово": 4,
    "Соколиная Гора": 7,
    "Кузьминки": 6,
    "Речной вокзал": 4,
    "Улица Горчакова": 3,
    "Москва-Товарная": 9,
    "Багратионовская": 7,
    "Верхние Лихоборы": 4,
    "Чертановская": 5,
    "Грачёвская": 4,
    "Стахановская": 5,
    "Лухмановская": 4,
    "Пятницкое шоссе": 2,
    "Рязанский проспект": 7, 
    "Нахимовский проспект": 7, 
    "Борисово": 4, 
    "Калужская": 6,
    "Домодедовская": 4, 
    "Каширская": 5,
    "Улица Скобелевская": 4,
    "Пражская": 5,
    "Лефортово": 6,
    "Бунинская аллея": 4,
    "Каховская": 5,
    "Аннино": 4,
    "Шоссе Энтузиастов": 6,
    "Улица Академика Янгеля": 5,
    "Марьина Роща": 8,
    "Алтуфьево": 5,
    "Очаково": 4,
    "Алма-Атинская": 5,
    "Улица Дмитриевского": 5,
    "Воронцовская": 6,
    "Генерала Тюленева": 5,
    "Курьяново": 5,
    "Зябликово": 4,
    "Жулебино": 6,
    "Бабушкинская": 5,
    "Волжская": 6,
    "Зеленоград — Крюково": 1,
    "Бульвар Адмирала Ушакова": 5,
    "Улица Старокачаловская": 4,
    "Москворечье": 6,
    "Савёловская": 7,
    "Бибирево": 5,
    "Первомайская": 5,
    "Волоколамская": 4,
    "Долгопрудная": 2,
    "Зорге": 5,
    "Медведково": 4,
    "Боровское шоссе": 5,
    "Красносельская": 9,
    "Сетунь": 5,
    "Кленовый бульвар": 6,
    "Филёвский парк": 7,
     "Калитники": 6,
    "Юго-Восточная": 6,
    "Тульская": 8,
    "Котельники": 3,
    "Текстильщики": 6,
    "Окская": 4
}

# Обновим значения метро в соответствующем столбце
for row in ws.iter_rows(min_row=2, max_row=ws.max_row, min_col=8, max_col=8):  # Столбец с метро - 8
    metro = row[0].value
    if metro in metro_ratings:
        row[0].value = metro_ratings[metro]

# Сохраняем изменённый файл
wb.save("flats_with_metro_ratings.xlsx")

print("✅ Метро заменено на рейтинги. Сохранено в flats_with_metro_ratings.xlsx")