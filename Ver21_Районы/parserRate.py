import openpyxl

# Загрузим существующий Excel-файл
wb = openpyxl.load_workbook("flats.xlsx")
ws = wb.active

# Словарь с рейтингами для районов
district_ratings = {
    "Фили-Давыдково": 7,
    "Очаково-Матвеевское": 6,
    "Филевский парк": 8,
    "Кунцево": 7,
    "Донской": 5,
    "Раменки": 8,
    "Даниловский": 7,
    "Замоскворечье": 8,
    "Пресненский": 9,
    "Лефортово": 5,
    "Дорогомилово": 6,
    "Басманный": 8,
    "Таганский": 7,
    "Южнопортовый": 6,
    "Щукино": 7,
    "Красносельский": 8,
    "Хамовники": 9,
    "Братеево": 4,
    "Строгино": 8,
    "Алексеевский": 7,
    "Левобережный": 7,
    "Отрадное": 5,
    "Хорошевский": 8,
    "Мичуринский проспект": 7,
    "Хорошево-Мневники": 7,
    "Царицыно": 6,
    "Покровское-Стрешнево": 5,
    "Арбат": 9,
    "Аэропорт": 8,
    "Жилой комплекс остров": 7,
    "Северное Бутово": 5,
    "Тверской": 8,
    "Можайский": 7,
    "Зюзино": 5,
    "Люблино": 7,
    "Мещанский": 8,
    "Беговой": 7,
    "Марьина роща": 7,
    "Академический": 8,
    "Савеловский": 7,
    "Бибирево": 5,
    "Обручевский": 7,
    "Гагаринский": 9,
    "Крылатское": 8,
    "Останкинский": 8,
    "Михалковская": 4,
    "Преображенское": 7,
    "Дмитровский": 5,
    "Тропарево-Никулино": 7,
    "Снежная": 4,
    "Головинский": 7,
    "Коньково": 7,
    "Якиманка": 8,
    "Богородское": 7,
    "Северный ао": 7,
    "Печатники": 5,
    "Кузьминки": 5,
    "Южное Тушино": 6,
    "Котловка": 5,
    "Марьино": 6,
    "Проспект Вернадского": 8,
    "Митино": 7,
    "Западное Дегунино": 5,
    "Черемушки": 6,
    "Марфино": 6,
    "Свиблово": 7,
    "Рязанский": 5,
    "Тимирязевский": 7,
    "Нагорный": 7,
    "Вильгельма Пика": 5,
    "Нижегородский": 6,
    "Орехово-Борисово Северное": 7,
    "Ясенево": 5,
    "Гольяново": 7,
    "Чертаново Южное": 5,
    "Орехово-Борисово Южное": 5,
    "Южное Бутово": 5,
    "Нагатино-Садовники": 6,
    "Чертаново Центральное": 6,
    "Войковский": 7,
    "Коптево": 7,
    "Нагатинский затон": 5,
    "Ярославский": 5,
    "Ховрино": 5,
    "Соколиная гора": 5,
    "Северное Тушино": 7,
    # Добавленные районы
    "Бирюлево Восточное": 4,
    "Ломоносовский": 6,
    "Сокольники": 7,
    "Ивановское": 4,
    "Сокол": 5,
    "Москворечье-Сабурово": 5,
    "Чертаново Северное": 5,
    "Некрасовка": 4,
    "Северный": 4,
    "Бирюлево Западное": 4,
    "Измайлово": 6,
    "Ново-Переделкино": 5,
    "Бескудниковский": 6,
    "Выхино-Жулебино": 4,
    "Теплый Стан": 6,
    "Солнцево": 5,
    "Бутырский": 6,
}

# Обновим значения районов в столбце "district"
for row in ws.iter_rows(min_row=2, max_row=ws.max_row, min_col=7, max_col=7):  # Столбец с районами - 7
    district = row[0].value
    if district in district_ratings:
        row[0].value = district_ratings[district]

# Сохраняем изменённый файл
wb.save("flats_with_ratings.xlsx")

print("✅ Районы заменены на рейтинги. Сохранено в flats_with_ratings.xlsx")
